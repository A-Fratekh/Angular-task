<!-- Header and Search Bar -->
<div class="d-flex flex-column flex-md-row justify-content-between align-items-center mb-3">
    <h1 class="mb-3 mb-md-0">Appraisals</h1>
    <app-search-bar [mode]="selectedTabStr" (searchString)="searchChangeHandler($event)"> </app-search-bar>
</div>

<!-- Tabs -->
<app-nav-bar (tabSelected)="switchTabHandler($event)"></app-nav-bar>

<!-- Filter Row -->
<ng-container *ngIf="selectedTab===selectedTabEnum.ForAppraisal || selectedTab===selectedTabEnum.ForReview">

    <div
        class="d-flex flex-column flex-md-row justify-content-center justify-content-md-start align-items-center rounded p-3 mb-4 filter">
        <div class="d-flex w-50 justify-content-center justify-content-md-start align-items-start mb-2 mb-md-0">
            <label class="label me-2 mb-0">Show:</label>
            <div class="form-check form-check-inline">
                <label class="radio-option">
                    <input class="form-check-input" type="radio" name="filterOption" value="process"
                        [(ngModel)]="filter">
                    <span>In process</span>
                </label>
            </div>
            <div class="form-check form-check-inline">
                <label class="radio-option">
                    <input class="form-check-input" type="radio" name="filterOption" value="history"
                        [(ngModel)]="filter">
                    <span>History</span>
                </label>
            </div>
        </div>

        <div class="d-flex w-100 justify-content-center justify-content-md-start align-items-center">
            <div
                class="filter-dropdowns flex-column flex-md-row d-flex justify-content-center justify-content-md-start  align-items-center">
                <div class="dropdown-container">
                    <span class="dropdown-label w-100" for="appraisalType">Appraisal type:</span>
                    <select id="appraisalType" class="dropdown text-small text-muted fs-7" [(ngModel)]="appraisalType"
                        (change)="filterByAppraisalType()">
                        <option value="">Select</option>
                        <option *ngFor="let type of appraisalTypes" [value]="type">{{ type }}</option>
                    </select>
                </div>
            </div>
            <div *ngIf="filter === 'process'"
                class="filter-dropdowns flex-column flex-md-row d-flex justify-content-center justify-content-md-start  align-items-center">
                <div class="dropdown-container">
                    <span class="dropdown-label mx-2 w-100" for="periodType">Period:</span>
                    <select id="periodType" class="dropdown text-small text-muted fs-7" [(ngModel)]="periodType"
                        (change)="filterByPeriodType()">
                        <option value="">Select</option>
                        <option *ngFor="let period of periodTypes" [value]="period">{{ period }}</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
</ng-container>

<ng-container *ngIf="selectedTab===selectedTabEnum.ForPosting">
    <div
        class="d-flex flex-column flex-md-row align-items-center justify-content-start border-0 rounded p-3 mb-4 filter">
        <div class="d-flex align-items-center">
            <div class="dropdown-container">
                <span class="dropdown-label mx-2 w-100" for="adminUnit">Admin Unit:</span>
                <select id="adminUnit" class="dropdown text-small text-muted fs-7" [(ngModel)]="adminUnit"
                    (change)="filterByAdminUnit()">
                    <option value="">Select</option>
                    <option *ngFor="let unit of adminUnits" [value]="unit">{{ unit }}</option>
                </select>
            </div>
        </div>
    </div>
</ng-container>

<ng-container *ngIf="selectedTab===selectedTabEnum.ForAppraisal || selectedTab===selectedTabEnum.ForReview">
    <app-card-view [items]="filteredList" [view]="filter" [headerTemplate]="cardHeader" [bodyTemplate]="cardBody"
        [selectedTab]="selectedTabStr" [footerTemplate]="cardFooter" (startAppraisal)="startAppraisalHandler($event)"
        (continueAppraisal)="continueAppraisalHandler($event)" (reviewAppraisal)="reviewAppraisalHandler($event)">

    </app-card-view>

    <!-- Card Header -->
    <ng-template #cardHeader let-data></ng-template>

    <!-- Card Body -->
    <ng-template #cardBody let-data></ng-template>

    <!-- Card Footer handled inside component -->
    <ng-template #cardFooter let-item></ng-template>
</ng-container>

<ng-container *ngIf="selectedTab === selectedTabEnum.ForPosting">
    <app-grid-view [items]="filteredList" [adminUnits]="adminUnits" (postingAppraisal)="postingAppraisalHandler($event)">
    </app-grid-view>
</ng-container>